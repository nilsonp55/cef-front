<div class="mat-table-custom">
  <div class="table-filter-container">
    <mat-form-field appearance="fill">
      <mat-label>Tipo Punto</mat-label>
      <mat-select [(ngModel)]="puntoSeleccionado" (selectionChange)="onFilterChange()">
        <mat-option [value]="undefined">Ninguno</mat-option>
        <mat-option *ngFor="let tipoPunto of tiposPuntoOptions" [value]="tipoPunto">
          {{tipoPunto.valorTexto}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field appearance="fill" id="field-bancos-list">
      <mat-label>Banco</mat-label>
      <mat-select [(ngModel)]="filtroBancoSelect" (selectionChange)="onFilterChange()">
        <mat-option [value]="undefined">Ninguno</mat-option>
        <mat-option *ngFor="let item of bancosOptions" [value]="item">
          {{item.nombreBanco}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field appearance="fill" id="field-transportadoras-list">
      <mat-label>Transportadora</mat-label>
      <mat-select [(ngModel)]="filtroTransportaSelect" (selectionChange)="onFilterChange()">
        <mat-option [value]="undefined">Ninguno</mat-option>
        <mat-option *ngFor="let item of transportadorasOptions" [value]="item">
          {{item.nombreTransportadora}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field appearance="fill">
      <mat-label>Ciudad</mat-label>
      <mat-select [(ngModel)]="listCiudadSelect" (selectionChange)="onFilterChange()">
        <mat-option [value]="undefined">Ninguno</mat-option>
        <mat-option *ngFor="let item of ciudadesOptions" [value]="item">
          {{item.nombreCiudad}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field appearance="fill">
      <mat-label>Código Propio</mat-label>
      <input type="text" matInput [(ngModel)]="filtroCodigoPropio"
        (blur)="onFilterChange()">
    </mat-form-field>
  </div>
  <div class="controls-container">
    <button mat-raised-button color="primary" class="button-custom" (click)="editItem.emit()">Nuevo</button>
    <button mat-raised-button color="primary" class="button-custom" (click)="onExportTable()">Exportar</button>
    <div class="paginator-area">
      <mat-paginator [pageSize]="cantPagina" [pageSizeOptions]="pageSizeOptions" [length]="totalRecords"
        (page)="onPageChange($event)" showFirstLastButtons>
      </mat-paginator>
    </div>
  </div>
  <div *ngIf="spinnerActive" class="disenio-spinner">
    <mat-spinner></mat-spinner>
  </div>
  <div *ngIf="!spinnerActive">
    <table mat-table matTableExporter [dataSource]="dataSource" matSort #exporter="matTableExporter"
      class="mat-elevation-z8" aria-label="puntos-codigo-tdv">
      <tr>
        <ng-container matColumnDef="idPuntoCodigoTdv">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
          <td mat-cell *matCellDef="let element"> {{element.idPuntoCodigoTdv}} </td>
        </ng-container>
        <ng-container matColumnDef="codigoPunto">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>CÓDIGO PUNTO</th>
          <td mat-cell *matCellDef="let element"> {{element.codigoPunto}} </td>
        </ng-container>
        <ng-container matColumnDef="tipoPunto">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>TIPO PUNTO</th>
          <td mat-cell *matCellDef="let element"> {{element.puntosDTO.tipoPunto}} </td>
        </ng-container>
        <ng-container matColumnDef="codigoTdv">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>CÓDIGO TDV</th>
          <td mat-cell *matCellDef="let element"> {{element.codigoTDV}} </td>
        </ng-container>
        <ng-container matColumnDef="codigoPropioTdv">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>CÓDIGO PROPIO TDV</th>
          <td mat-cell *matCellDef="let element"> {{element.codigoPropioTDV}} </td>
        </ng-container>
        <ng-container matColumnDef="nombrePunto">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>PUNTO</th>
          <td mat-cell *matCellDef="let element"> {{element.puntosDTO.nombrePunto}} </td>
        </ng-container>
        <ng-container matColumnDef="nombreBanco">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>BANCO</th>
          <td mat-cell *matCellDef="let element"> {{element.bancosDTO.nombreBanco}} </td>
        </ng-container>
        <ng-container matColumnDef="codigoCiudad">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>CIUDAD FONDO</th>
          <!-- resolverCiudadFondo will be a method in this component, needs 'ciudades' list -->
          <td mat-cell *matCellDef="let element"> {{resolveCiudadNombre(element.ciudadFondo)}} </td>
        </ng-container>
        <!-- <ng-container matColumnDef="estado">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>ESTADO</th>
          <td mat-cell *matCellDef="let element"> {{resolveEstado(element.estado)}} </td>
        </ng-container> -->
        <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef> EDITAR</th>
          <td mat-cell *matCellDef="let element">
            <button mat-button (click)="editItem.emit(element)">
              <mat-icon style="color: green">edit</mat-icon>
            </button>
          </td>
        </ng-container>
      </tr>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr> <!-- Changed to displayedColumns -->
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr> <!-- Changed to displayedColumns -->
    </table>
  </div>
</div>